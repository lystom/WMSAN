<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Synthetic Cross-Correlation Functions - WMSAN</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Synthetic Cross-Correlation Functions";
        var mkdocs_page_input_path = "api_overview/synthetics.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../..">
          <img src="../../img/logowmsan.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../getting_started/">Getting Started</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">API Overview</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../api_overview/">Index</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../read_hs_p2l/">Read WW3 Files</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../body_waves/">Body Wave</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../rayleigh_waves/">Rayleigh Wave</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../temporal_variations/">Temporal Variations</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Synthetic Cross-Correlation Functions</a>
    <ul class="current">
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../wmsan_to_noisi/">To noisi</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">User Guide</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../user_guide/">Tutorials</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Site Effect</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../notebooks/rayleigh_waves/amplification_coeff/">Rayleigh Waves Site Effect</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notebooks/body_waves/amplification_coeff/">Body Waves Site Effect</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Equivalent Vertical Force Maps</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../notebooks/rayleigh_waves/microseismic_sources/">Rayleigh Waves Equivalent Vertical Force</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notebooks/body_waves/microseismic_sources/">Body Waves Equivalent Vertical Force</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../notebooks/rayleigh_waves/temporal_variations/">Rayleigh Waves Temporal Variations</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Synthetic Cross-Correlation Functions</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../notebooks/rayleigh_waves/synthetic_CCF/">Rayleigh Waves Synthetic Cross-correlation Functions</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notebooks/body_waves/synthetic_CCF/">Body Waves Synthetics Cross-correlation Functions</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../notebooks/rayleigh_waves/wmsan_to_noisi/">WMSAN to noisi</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Synthetic Spectrograms</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../notebooks/rayleigh_waves/rayleigh_source/">Rayleigh Waves Power Spectrum of Vertical Displacement</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notebooks/rayleigh_waves/spectrograms/">Rayleigh Waves Synthetic Spectrograms</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Developer Guide</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../developer_guide/">How to contribute ?</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">About</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../about/">About</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">WMSAN</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">API Overview</li>
      <li class="breadcrumb-item active">Synthetic Cross-Correlation Functions</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h2 id="synthetics-cross-correlation-functions">Synthetics Cross-Correlation Functions</h2>


<div class="doc doc-object doc-module">



<a id="wmsan.synthetics"></a>
    <div class="doc doc-contents first">

      <p>Functions to generate synthetic cross-correlations from secondary microseisms sources.</p>
<p>It contains fourteen functions:</p>
<ul>
<li>
<p><code>apply_delay_f_domain(s,d)</code>: Apply a delay d to the input signal s using Fourier domain.</p>
</li>
<li>
<p><code>get_synthetic_info(path_file_axisem, comp)</code>: Get synthetic info from a specified h5 file and return fe, time, and N.</p>
</li>
<li>
<p><code>open_axisem(dist, path_file_axisem, comp)</code>: Reads an AxiSEM .h5 archive in a 1D model given its path and a distance.</p>
</li>
<li>
<p><code>taper_axisem_archive(time, distance, archive_name, umin, umax)</code>: Taper an AxiSEM .h5 archive in a 1D model given its path and a distance and minimum and maximum Rayleigh wave velocity.</p>
</li>
<li>
<p><code>taper_axisem_archive_body_waves(time, distance, archive_name, phase1, phase2, model, **kwargs)</code>: Taper an AxiSEM .h5 archive around two body wave phases in a 1D model given its path and a distance.</p>
</li>
<li>
<p><code>create_spectrum_archive(time, distance, tapered_archive, h5_name_spectrum)</code>: Create a Green's function archive in frequency domain from an AxiSEM archive.</p>
</li>
<li>
<p><code>open_archive(h5_name)</code>: Open a Green's function archive in frequency domain.</p>
</li>
<li>
<p><code>open_spectrum_axisem(path_file_axisem, comp)</code>: Reads an AxiSEM .h5 archive in a 1D model given its path and a distance, and returns sampling frequency, time vector and trace.</p>
</li>
<li>
<p><code>create_date_vect(dates)</code>: Create a date vector from a list of dates.</p>
</li>
<li>
<p><code>open_model(path_file_WW3, date_vect, N, fe, lon_slice, lat_slice)</code>: Open WW3 model for ambient noise sources at a specific time and date.</p>
</li>
<li>
<p><code>distance_to_station(lon, lat, lon_s, lat_s, radius_earth)</code>: Computes the distance of every point of the model to station of coordinates (lonS, latS).</p>
</li>
<li>
<p><code>matrix_GF(spectrum_axi, lon, lat, N, distance_s, comp, conjugate)</code>: Generates a synthetic seismogram (Green's Functions) matrix to a specific station in frequency domain using the given lon, lat, N, path_file_axisem, distance_s, and optional conjugate flag.</p>
</li>
<li>
<p><code>compute_model_chunk(lon_inf, lon_sup, lat_inf, lat_sup, N, fe, date_vect, spectrum_axi, file_model, lon_staA, lat_staA, lon_staB, lat_staB, comp)</code>: Compute correlation function in frequency domain between stations A and B for a chunk of the www3 model source.</p>
</li>
<li>
<p><code>ccf_computation(coords_staA, coords_staB, path_model, date_vect, spectrum_axi, fe, N, extent, comp)</code>: Compute the cross-correlation function between two seismic stations.</p>
</li>
</ul>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="wmsan.synthetics.apply_delay_f_domain" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_delay_f_domain</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Apply a delay d to the input signal s using Fourier domain.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>s</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              –
              <div class="doc-md-description">
                <p>The input signal to apply delay.</p>
              </div>
            </li>
            <li>
              <b><code>d</code></b>
                  (<code>float</code>, default:
                      <code>0.0</code>
)
              –
              <div class="doc-md-description">
                <p>The delay to apply to the input signal.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>s_delayed</code></b>(                  <code><span title="numpy.ndarray">ndarray</span></code>
)              –
              <div class="doc-md-description">
                <p>The delayed input signal.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wmsan/synthetics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">apply_delay_f_domain</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">d</span><span class="o">=</span><span class="mf">0.</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply a delay d to the input signal s using Fourier domain.</span>

<span class="sd">    Args:</span>
<span class="sd">        s (numpy.ndarray): The input signal to apply delay.</span>
<span class="sd">        d (float, optional): The delay to apply to the input signal.</span>

<span class="sd">    Returns:    </span>
<span class="sd">        s_delayed (numpy.ndarray): The delayed input signal.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">## apply a delay d to the input signal s</span>
    <span class="n">d_phase</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">d</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>  <span class="c1"># phase associated to d</span>
    <span class="n">d_phase</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">d_phase</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))::]</span><span class="o">-=</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">d</span>  <span class="c1"># for the hermitian symmetry of the fft</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">d_phase</span><span class="p">)))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="wmsan.synthetics.ccf_computation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ccf_computation</span><span class="p">(</span><span class="n">coords_staA</span><span class="p">,</span> <span class="n">coords_staB</span><span class="p">,</span> <span class="n">path_model</span><span class="p">,</span> <span class="n">date_vect</span><span class="p">,</span> <span class="n">spectrum_axi</span><span class="p">,</span> <span class="n">fe</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">14400</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">81</span><span class="p">],</span> <span class="n">comp</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Computes the cross-correlation function between two seismic stations.
It takes the coordinates of the stations, the path to the AxiSEM archive, the path to the model, 
a vector of dates, a normalization factor, and a component parameter. 
It returns the computed cross-correlation function and the corresponding time array.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>coords_staA</code></b>
                  (<code>tuple</code>)
              –
              <div class="doc-md-description">
                <p>Coordinates of station A (longitude, latitude).</p>
              </div>
            </li>
            <li>
              <b><code>coords_staB</code></b>
                  (<code>tuple</code>)
              –
              <div class="doc-md-description">
                <p>Coordinates of station B (longitude, latitude).</p>
              </div>
            </li>
            <li>
              <b><code>path_model</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Path to the WW3 PSD model.</p>
              </div>
            </li>
            <li>
              <b><code>date_vect</code></b>
                  (<code>list</code>)
              –
              <div class="doc-md-description">
                <p>Vector of dates (year, month, day, hour).</p>
              </div>
            </li>
            <li>
              <b><code>spectrum_axi</code></b>
                  (<code>array</code>)
              –
              <div class="doc-md-description">
                <p>AxiSEM spectrum.</p>
              </div>
            </li>
            <li>
              <b><code>fe</code></b>
                  (<code>float</code>, default:
                      <code>4.0</code>
)
              –
              <div class="doc-md-description">
                <p>Sampling frequency.</p>
              </div>
            </li>
            <li>
              <b><code>N</code></b>
                  (<code>int</code>, default:
                      <code>14400</code>
)
              –
              <div class="doc-md-description">
                <p>Number of points.</p>
              </div>
            </li>
            <li>
              <b><code>extent</code></b>
                  (<code>list</code>, default:
                      <code>[-180, 181, -80, 81]</code>
)
              –
              <div class="doc-md-description">
                <p>Longitude and latitude slices.</p>
              </div>
            </li>
            <li>
              <b><code>comp</code></b>
                  (<code>str</code>, default:
                      <code>&#39;Z&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>Component parameter.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>corr</code></b>(                  <code><span title="xarray.DataArray">DataArray</span></code>
)              –
              <div class="doc-md-description">
                <p>Synthetic correlation in time domain.</p>
              </div>
            </li>
            <li>
<b><code>time_corr</code></b>(                  <code><span title="numpy.ndarray">ndarray</span></code>
)              –
              <div class="doc-md-description">
                <p>Time array.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wmsan/synthetics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">ccf_computation</span><span class="p">(</span><span class="n">coords_staA</span><span class="p">,</span> <span class="n">coords_staB</span><span class="p">,</span> <span class="n">path_model</span><span class="p">,</span> <span class="n">date_vect</span><span class="p">,</span> <span class="n">spectrum_axi</span><span class="p">,</span> <span class="n">fe</span><span class="o">=</span><span class="mf">4.</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">14400</span><span class="p">,</span> <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">81</span><span class="p">],</span> <span class="n">comp</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the cross-correlation function between two seismic stations.</span>
<span class="sd">    It takes the coordinates of the stations, the path to the AxiSEM archive, the path to the model, </span>
<span class="sd">    a vector of dates, a normalization factor, and a component parameter. </span>
<span class="sd">    It returns the computed cross-correlation function and the corresponding time array.</span>

<span class="sd">    Args:</span>
<span class="sd">        coords_staA (tuple): Coordinates of station A (longitude, latitude).</span>
<span class="sd">        coords_staB (tuple): Coordinates of station B (longitude, latitude).</span>
<span class="sd">        path_model (str): Path to the WW3 PSD model.</span>
<span class="sd">        date_vect (list): Vector of dates (year, month, day, hour).</span>
<span class="sd">        spectrum_axi (array): AxiSEM spectrum.</span>
<span class="sd">        fe (float, optional): Sampling frequency.</span>
<span class="sd">        N (int, optional): Number of points.</span>
<span class="sd">        extent (list, optional): Longitude and latitude slices.</span>
<span class="sd">        comp (str, optional): Component parameter.</span>

<span class="sd">    Returns:</span>
<span class="sd">        corr (xarray.DataArray): Synthetic correlation in time domain.</span>
<span class="sd">        time_corr (numpy.ndarray): Time array.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">## Coordinates of stations</span>
    <span class="n">lon_staA</span> <span class="o">=</span> <span class="n">coords_staA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">lat_staA</span> <span class="o">=</span> <span class="n">coords_staA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">lon_staB</span> <span class="o">=</span> <span class="n">coords_staB</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">lat_staB</span> <span class="o">=</span> <span class="n">coords_staB</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1">## Open WW3 PSD</span>
    <span class="n">YEAR</span> <span class="o">=</span> <span class="n">date_vect</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">MONTH</span> <span class="o">=</span> <span class="n">date_vect</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">DAY</span> <span class="o">=</span> <span class="n">date_vect</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">HOUR</span> <span class="o">=</span> <span class="n">date_vect</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

    <span class="n">file_model</span> <span class="o">=</span> <span class="n">path_model</span> <span class="o">+</span> <span class="s1">&#39;F_</span><span class="si">%d%02d%02d%02d</span><span class="s1">.nc&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">YEAR</span><span class="p">,</span> <span class="n">MONTH</span><span class="p">,</span> <span class="n">DAY</span><span class="p">,</span> <span class="n">HOUR</span><span class="p">)</span>
    <span class="n">paramlist</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1">## Define longitude and latitude slices</span>
    <span class="n">number_of_cpu</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span>
    <span class="n">lon_inf</span><span class="p">,</span> <span class="n">lon_sup</span> <span class="o">=</span> <span class="n">extent</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">extent</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">lat_inf</span><span class="p">,</span> <span class="n">lat_sup</span> <span class="o">=</span> <span class="n">extent</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">extent</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

    <span class="n">corr_f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">complex</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">compute_model_chunk</span><span class="p">(</span><span class="n">lon_inf</span><span class="p">,</span> <span class="n">lon_sup</span><span class="p">,</span> <span class="n">lat_inf</span><span class="p">,</span> <span class="n">lat_sup</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">fe</span><span class="p">,</span> <span class="n">date_vect</span><span class="p">,</span> <span class="n">spectrum_axi</span><span class="p">,</span> <span class="n">file_model</span><span class="p">,</span> <span class="n">lon_staA</span><span class="p">,</span> <span class="n">lat_staA</span><span class="p">,</span> <span class="n">lon_staB</span><span class="p">,</span> <span class="n">lat_staB</span><span class="p">,</span> <span class="n">comp</span><span class="p">)</span>

    <span class="n">corr_f</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span>
    <span class="k">if</span> <span class="n">N</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">corr_f</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">::]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">corr_f</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">]))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">complex</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">corr_f</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">::]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">corr_f</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">]))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">complex</span><span class="p">)</span>
    <span class="c1">## Correlation in Time Domain</span>
    <span class="n">corr</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">corr_f</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">real</span>
    <span class="n">corr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span>
    <span class="n">corr</span> <span class="o">*=</span> <span class="mf">1e-40</span>
    <span class="n">time_corr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="o">/</span><span class="n">fe</span>

    <span class="n">corr</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">time_corr</span><span class="p">},</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;synthetic correlation&#39;</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">corr_f</span>    
    <span class="k">return</span> <span class="n">corr</span><span class="p">,</span> <span class="n">time_corr</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="wmsan.synthetics.compute_model_chunk" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_model_chunk</span><span class="p">(</span><span class="n">lon_inf</span><span class="p">,</span> <span class="n">lon_sup</span><span class="p">,</span> <span class="n">lat_inf</span><span class="p">,</span> <span class="n">lat_sup</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">fe</span><span class="p">,</span> <span class="n">date_vect</span><span class="p">,</span> <span class="n">spectrum_axi</span><span class="p">,</span> <span class="n">file_model</span><span class="p">,</span> <span class="n">lon_staA</span><span class="p">,</span> <span class="n">lat_staA</span><span class="p">,</span> <span class="n">lon_staB</span><span class="p">,</span> <span class="n">lat_staB</span><span class="p">,</span> <span class="n">comp</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Computes correlation function between stations A and B for a chunk of the www3 model source.   </p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>lon_inf</code></b>
                  (<code>float</code>)
              –
              <div class="doc-md-description">
                <p>Lower longitude bound.</p>
              </div>
            </li>
            <li>
              <b><code>lon_sup</code></b>
                  (<code>float</code>)
              –
              <div class="doc-md-description">
                <p>Upper longitude bound.</p>
              </div>
            </li>
            <li>
              <b><code>lat_inf</code></b>
                  (<code>float</code>)
              –
              <div class="doc-md-description">
                <p>Lower latitude bound.</p>
              </div>
            </li>
            <li>
              <b><code>lat_sup</code></b>
                  (<code>float</code>)
              –
              <div class="doc-md-description">
                <p>Upper latitude bound.</p>
              </div>
            </li>
            <li>
              <b><code>N</code></b>
                  (<code>int</code>)
              –
              <div class="doc-md-description">
                <p>Number of points.</p>
              </div>
            </li>
            <li>
              <b><code>fe</code></b>
                  (<code>float</code>)
              –
              <div class="doc-md-description">
                <p>Sampling frequency.</p>
              </div>
            </li>
            <li>
              <b><code>date_vect</code></b>
                  (<code>array</code>)
              –
              <div class="doc-md-description">
                <p>Vector of dates.</p>
              </div>
            </li>
            <li>
              <b><code>spectrum_axi</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              –
              <div class="doc-md-description">
                <p>Axisem archive spectrum.</p>
              </div>
            </li>
            <li>
              <b><code>file_model</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>WW3 PSD file.</p>
              </div>
            </li>
            <li>
              <b><code>lon_staA</code></b>
                  (<code>float</code>)
              –
              <div class="doc-md-description">
                <p>Longitude of station A.</p>
              </div>
            </li>
            <li>
              <b><code>lat_staA</code></b>
                  (<code>float</code>)
              –
              <div class="doc-md-description">
                <p>Latitude of station A.</p>
              </div>
            </li>
            <li>
              <b><code>lon_staB</code></b>
                  (<code>float</code>)
              –
              <div class="doc-md-description">
                <p>Longitude of station B.</p>
              </div>
            </li>
            <li>
              <b><code>lat_staB</code></b>
                  (<code>float</code>)
              –
              <div class="doc-md-description">
                <p>Latitude of station B.</p>
              </div>
            </li>
            <li>
              <b><code>comp</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Component.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>corr_f</code></b>(                  <code><span title="numpy.ndarray">ndarray</span></code>
)              –
              <div class="doc-md-description">
                <p>Computed correlation function as a single precision complex array.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wmsan/synthetics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_model_chunk</span><span class="p">(</span><span class="n">lon_inf</span><span class="p">,</span> <span class="n">lon_sup</span><span class="p">,</span> <span class="n">lat_inf</span><span class="p">,</span> <span class="n">lat_sup</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">fe</span><span class="p">,</span> <span class="n">date_vect</span><span class="p">,</span> <span class="n">spectrum_axi</span><span class="p">,</span> <span class="n">file_model</span><span class="p">,</span> <span class="n">lon_staA</span><span class="p">,</span> <span class="n">lat_staA</span><span class="p">,</span> <span class="n">lon_staB</span><span class="p">,</span> <span class="n">lat_staB</span><span class="p">,</span> <span class="n">comp</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes correlation function between stations A and B for a chunk of the www3 model source.   </span>

<span class="sd">    Args:</span>
<span class="sd">        lon_inf (float): Lower longitude bound.</span>
<span class="sd">        lon_sup (float): Upper longitude bound.</span>
<span class="sd">        lat_inf (float): Lower latitude bound.</span>
<span class="sd">        lat_sup (float): Upper latitude bound.</span>
<span class="sd">        N (int): Number of points.</span>
<span class="sd">        fe (float): Sampling frequency.</span>
<span class="sd">        date_vect (array): Vector of dates.</span>
<span class="sd">        spectrum_axi (np.ndarray): Axisem archive spectrum.</span>
<span class="sd">        file_model (str): WW3 PSD file.</span>
<span class="sd">        lon_staA (float): Longitude of station A.</span>
<span class="sd">        lat_staA (float): Latitude of station A.</span>
<span class="sd">        lon_staB (float): Longitude of station B.</span>
<span class="sd">        lat_staB (float): Latitude of station B.</span>
<span class="sd">        comp (str): Component.</span>

<span class="sd">    Returns:</span>
<span class="sd">        corr_f (np.ndarray): Computed correlation function as a single precision complex array.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">## Open model</span>
    <span class="n">psd_model</span> <span class="o">=</span> <span class="n">open_model</span><span class="p">(</span><span class="n">path_file_WW3</span><span class="o">=</span><span class="n">file_model</span><span class="p">,</span> <span class="n">date_vect</span><span class="o">=</span><span class="n">date_vect</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">fe</span><span class="o">=</span><span class="n">fe</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">lon_inf</span><span class="p">,</span> <span class="n">lon_sup</span><span class="p">),</span> <span class="n">lat_slice</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">lat_inf</span><span class="p">,</span> <span class="n">lat_sup</span><span class="p">))</span>
    <span class="n">psd_model</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">psd_model</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">complex</span><span class="p">)</span>
    <span class="n">lon</span> <span class="o">=</span> <span class="n">psd_model</span><span class="o">.</span><span class="n">longitude</span>
    <span class="n">lat</span> <span class="o">=</span> <span class="n">psd_model</span><span class="o">.</span><span class="n">latitude</span>
    <span class="c1">## Distances</span>
    <span class="n">distance_staA</span> <span class="o">=</span> <span class="n">distance_to_station</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon_s</span> <span class="o">=</span> <span class="n">lon_staA</span><span class="p">,</span> <span class="n">lat_s</span> <span class="o">=</span> <span class="n">lat_staA</span><span class="p">)</span>
    <span class="n">distance_staB</span> <span class="o">=</span> <span class="n">distance_to_station</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon_s</span> <span class="o">=</span> <span class="n">lon_staB</span><span class="p">,</span> <span class="n">lat_s</span> <span class="o">=</span> <span class="n">lat_staB</span><span class="p">)</span>

    <span class="c1">## Green&#39;s Functions spectrum</span>
    <span class="n">psd_model</span><span class="o">.</span><span class="n">values</span> <span class="o">*=</span> <span class="n">matrix_GF</span><span class="p">(</span><span class="n">spectrum_axi</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">distance_s</span><span class="o">=</span><span class="n">distance_staA</span><span class="p">,</span> <span class="n">conjugate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="n">comp</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">complex</span><span class="p">)</span>

    <span class="c1">## Green&#39;s Functions spectrum</span>
    <span class="n">psd_model</span><span class="o">.</span><span class="n">values</span> <span class="o">*=</span> <span class="n">matrix_GF</span><span class="p">(</span><span class="n">spectrum_axi</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">distance_s</span><span class="o">=</span><span class="n">distance_staB</span><span class="p">,</span> <span class="n">conjugate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="n">comp</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">complex</span><span class="p">)</span>

    <span class="k">del</span> <span class="n">distance_staA</span><span class="p">,</span> <span class="n">distance_staB</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span> 
    <span class="c1">## Sum along coordinates latitude and longitude</span>
    <span class="k">return</span> <span class="n">psd_model</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">complex</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="wmsan.synthetics.create_date_vect" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_date_vect</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Creates a date vector from a list of dates.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>dates</code></b>
                  (<code>list</code>)
              –
              <div class="doc-md-description">
                <p>A list of datetime objects representing the dates.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>date_vect</code></b>(                  <code><span title="numpy.ndarray">ndarray</span></code>
)              –
              <div class="doc-md-description">
                <p>A 2D numpy array where each row represents a date and contains the year, month, day, and hour.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wmsan/synthetics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_date_vect</span><span class="p">(</span><span class="n">dates</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a date vector from a list of dates.</span>

<span class="sd">    Args:</span>
<span class="sd">        dates (list): A list of datetime objects representing the dates.</span>

<span class="sd">    Returns:</span>
<span class="sd">        date_vect (numpy.ndarray): A 2D numpy array where each row represents a date and contains the year, month, day, and hour.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">date_vect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">dates</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dates</span><span class="p">)):</span>
        <span class="n">date</span> <span class="o">=</span> <span class="n">dates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">,</span> <span class="n">hour</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">date</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">date</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="n">date</span><span class="o">.</span><span class="n">hour</span>
        <span class="n">date_vect</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">,</span> <span class="n">hour</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">date_vect</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="wmsan.synthetics.create_spectrum_archive" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_spectrum_archive</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">tapered_archive</span><span class="p">,</span> <span class="n">h5_name_spectrum</span><span class="o">=</span><span class="s1">&#39;spectrum_archive_tapered.h5&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Create a Green's function archive in frequency domain from an AxiSEM archive.
This function creates a spectrum archive by computing the Fourier transform of the input archive for each distance value.
The resulting spectrum is saved as an HDF5 file with the specified name. The HDF5 file contains three datasets:</p>
<p>'SPECTRUM': The spectrum data.</p>
<p>'frequency': The frequency values.</p>
<p>'distance': The distance values.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>time</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              –
              <div class="doc-md-description">
                <p>An array of time values.</p>
              </div>
            </li>
            <li>
              <b><code>distance</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              –
              <div class="doc-md-description">
                <p>An array of distance values.</p>
              </div>
            </li>
            <li>
              <b><code>tapered_archive</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              –
              <div class="doc-md-description">
                <p>The Green's Function archive in time domain file path.</p>
              </div>
            </li>
            <li>
              <b><code>h5_name_spectrum</code></b>
                  (<code>str</code>, default:
                      <code>&#39;spectrum_archive_tapered.h5&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>The name of the output HDF5 file.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>None</code></b>(                  <code>NoneType</code>
)              –
              <div class="doc-md-description">
                <p>The function saves the spectrum archive as an HDF5 file.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wmsan/synthetics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_spectrum_archive</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">tapered_archive</span><span class="p">,</span> <span class="n">h5_name_spectrum</span> <span class="o">=</span> <span class="s1">&#39;spectrum_archive_tapered.h5&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a Green&#39;s function archive in frequency domain from an AxiSEM archive.</span>
<span class="sd">    This function creates a spectrum archive by computing the Fourier transform of the input archive for each distance value.</span>
<span class="sd">    The resulting spectrum is saved as an HDF5 file with the specified name. The HDF5 file contains three datasets:</span>

<span class="sd">    &#39;SPECTRUM&#39;: The spectrum data.</span>

<span class="sd">    &#39;frequency&#39;: The frequency values.</span>

<span class="sd">    &#39;distance&#39;: The distance values.</span>

<span class="sd">    Args:</span>
<span class="sd">        time (numpy.ndarray): An array of time values.</span>
<span class="sd">        distance (numpy.ndarray): An array of distance values.</span>
<span class="sd">        tapered_archive (numpy.ndarray): The Green&#39;s Function archive in time domain file path.</span>
<span class="sd">        h5_name_spectrum (str, optional): The name of the output HDF5 file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None (NoneType): The function saves the spectrum archive as an HDF5 file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">time</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">fe</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dt</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
    <span class="n">freq</span> <span class="o">=</span> <span class="n">fftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fe</span><span class="p">)</span>
    <span class="n">spectrum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">distance</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">freq</span><span class="p">)))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">complex</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">dist</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">distance</span><span class="p">):</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">distance</span> <span class="o">-</span> <span class="n">dist</span><span class="p">))</span>
        <span class="n">W</span> <span class="o">=</span> <span class="n">tapered_archive</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">spectrum</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>

    <span class="c1"># Save as h5</span>
    <span class="n">h5_file</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5_name_spectrum</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">h5_file</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;SPECTRUM&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">spectrum</span><span class="p">)</span>
    <span class="n">h5_file</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;frequency&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">freq</span><span class="p">)</span>
    <span class="n">h5_file</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;distance&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">distance</span><span class="p">)</span>
    <span class="n">h5_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="wmsan.synthetics.distance_to_station" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">distance_to_station</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon_s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">lat_s</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">radius_earth</span><span class="o">=</span><span class="mf">6371000.0</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Computes the distance of every point of the model to station of coordinates (lonS, latS)</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>lon</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              –
              <div class="doc-md-description">
                <p>longitudes of the grid</p>
              </div>
            </li>
            <li>
              <b><code>lat</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              –
              <div class="doc-md-description">
                <p>latitude of the grid</p>
              </div>
            </li>
            <li>
              <b><code>lon_s</code></b>
                  (<code>float</code>, default:
                      <code>0</code>
)
              –
              <div class="doc-md-description">
                <p>station longitude </p>
              </div>
            </li>
            <li>
              <b><code>lat_s</code></b>
                  (<code>float</code>, default:
                      <code>90</code>
)
              –
              <div class="doc-md-description">
                <p>station latitude</p>
              </div>
            </li>
            <li>
              <b><code>radius_earth</code></b>
                  (<code>float</code>, default:
                      <code>6371000.0</code>
)
              –
              <div class="doc-md-description">
                <p>the radius of the Earth</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>distanceS</code></b>(                  <code><span title="numpy.ndarray">ndarray</span></code>
)              –
              <div class="doc-md-description">
                <p>distance to station S matrix of dimensions dim(lon) x dim(lat)</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wmsan/synthetics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">distance_to_station</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon_s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">lat_s</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">radius_earth</span><span class="o">=</span><span class="mf">6371e3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the distance of every point of the model to station of coordinates (lonS, latS)</span>

<span class="sd">    Args:</span>
<span class="sd">        lon (numpy.ndarray): longitudes of the grid</span>
<span class="sd">        lat (numpy.ndarray): latitude of the grid</span>
<span class="sd">        lon_s (float): station longitude </span>
<span class="sd">        lat_s (float): station latitude</span>
<span class="sd">        radius_earth (float): the radius of the Earth</span>

<span class="sd">    Returns:</span>
<span class="sd">        distanceS (np.ndarray): distance to station S matrix of dimensions dim(lon) x dim(lat) </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">geoid</span> <span class="o">=</span> <span class="n">Geod</span><span class="p">(</span><span class="n">ellps</span><span class="o">=</span><span class="s2">&quot;WGS84&quot;</span><span class="p">)</span>  <span class="c1"># set reference ellipsoid</span>
    <span class="p">(</span><span class="n">lat_grid</span><span class="p">,</span> <span class="n">lon_grid</span><span class="p">)</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">)</span>  <span class="c1"># grid used</span>

    <span class="n">lonSTA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">lon_grid</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">*</span><span class="n">lon_s</span>
    <span class="n">latSTA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">lat_grid</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">*</span><span class="n">lat_s</span>
    <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">distance_in_metersS</span><span class="p">)</span> <span class="o">=</span> <span class="n">geoid</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">lon_grid</span><span class="p">,</span> <span class="n">lat_grid</span><span class="p">,</span> <span class="n">lonSTA</span><span class="p">,</span> <span class="n">latSTA</span><span class="p">,</span> <span class="n">radians</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">distanceS</span> <span class="o">=</span> <span class="mf">180.0</span><span class="o">*</span><span class="n">distance_in_metersS</span><span class="o">/</span><span class="p">(</span><span class="n">radius_earth</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">distanceS</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">distanceS</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="n">lon</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="n">lat</span><span class="p">},</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;distance&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;°&#39;</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">distanceS</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="wmsan.synthetics.get_synthetic_info" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_synthetic_info</span><span class="p">(</span><span class="n">path_file_axisem</span><span class="o">=</span><span class="s1">&#39;../../data/NOISE_vertforce_dirac_0-ak135f_1.s_3600s.h5&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Function to get synthetic info from a specified h5 file and return fe, time, and N.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>path_file_axisem</code></b>
                  (<code>str</code>, default:
                      <code>&#39;../../data/NOISE_vertforce_dirac_0-ak135f_1.s_3600s.h5&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>path of axisem .h5 archive.</p>
              </div>
            </li>
            <li>
              <b><code>comp</code></b>
                  (<code>str</code>, default:
                      <code>&#39;Z&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>component.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>fe</code></b>(                  <code>float</code>
)              –
              <div class="doc-md-description">
                <p>sampling frequency</p>
              </div>
            </li>
            <li>
<b><code>time</code></b>(                  <code><span title="numpy.ndarray">ndarray</span></code>
)              –
              <div class="doc-md-description">
                <p>time vector</p>
              </div>
            </li>
            <li>
<b><code>N</code></b>(                  <code>int</code>
)              –
              <div class="doc-md-description">
                <p>number of points</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wmsan/synthetics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_synthetic_info</span><span class="p">(</span><span class="n">path_file_axisem</span><span class="o">=</span><span class="s1">&#39;../../data/NOISE_vertforce_dirac_0-ak135f_1.s_3600s.h5&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to get synthetic info from a specified h5 file and return fe, time, and N.</span>

<span class="sd">    Args:</span>
<span class="sd">        path_file_axisem (str, optional): path of axisem .h5 archive.</span>
<span class="sd">        comp (str, optional): component.</span>

<span class="sd">    Returns:</span>
<span class="sd">        fe (float): sampling frequency</span>
<span class="sd">        time (numpy.ndarray): time vector</span>
<span class="sd">        N (int): number of points</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">h5_file</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">path_file_axisem</span><span class="p">)</span>
        <span class="n">fe</span> <span class="o">=</span> <span class="n">h5_file</span><span class="p">[</span><span class="s1">&#39;_metadata&#39;</span><span class="p">][</span><span class="s1">&#39;fe&#39;</span><span class="p">][()]</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="n">trace</span> <span class="o">=</span> <span class="n">h5_file</span><span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">][</span><span class="s1">&#39;SYNTH</span><span class="si">%03d</span><span class="s1">.00&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">dist</span><span class="o">*</span><span class="mi">10</span><span class="p">)][</span><span class="n">comp</span><span class="p">][:]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">single</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;File not found&#39;</span><span class="p">,</span> <span class="n">path_file_axisem</span><span class="p">,</span> <span class="s2">&quot;Download the file from: https://zenodo.org/records/11126562 </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;Save in ../data/&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>  
    <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="o">/</span><span class="n">fe</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fe</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">single</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
    <span class="n">h5_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fe</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">N</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="wmsan.synthetics.matrix_GF" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">matrix_GF</span><span class="p">(</span><span class="n">spectrum_axi</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">distance_s</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">conjugate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Generates a synthetic seismogram (Green's Functions) matrix in frequency domain
using the given lon, lat, N, path_file_axisem, distance_s, and optional conjugate flag.
Returns the synthetic seismogram matrix.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>spectrum_axi</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              –
              <div class="doc-md-description">
                <p>synthetic seismogram in frequency domain</p>
              </div>
            </li>
            <li>
              <b><code>lon</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              –
              <div class="doc-md-description">
                <p>longitude of the grid</p>
              </div>
            </li>
            <li>
              <b><code>lat</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              –
              <div class="doc-md-description">
                <p>latitude of the grid</p>
              </div>
            </li>
            <li>
              <b><code>N</code></b>
                  (<code>int</code>)
              –
              <div class="doc-md-description">
                <p>number of samples</p>
              </div>
            </li>
            <li>
              <b><code>distance_s</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              –
              <div class="doc-md-description">
                <p>distance matrix</p>
              </div>
            </li>
            <li>
              <b><code>comp</code></b>
                  (<code>str</code>, default:
                      <code>&#39;Z&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>component</p>
              </div>
            </li>
            <li>
              <b><code>conjugate</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>conjugate flag</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>synth</code></b>(                  <code><span title="numpy.ndarray">ndarray</span></code>
)              –
              <div class="doc-md-description">
                <p>synthetic seismogram</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wmsan/synthetics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">matrix_GF</span><span class="p">(</span><span class="n">spectrum_axi</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">distance_s</span><span class="p">,</span> <span class="n">comp</span> <span class="o">=</span> <span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">conjugate</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates a synthetic seismogram (Green&#39;s Functions) matrix in frequency domain</span>
<span class="sd">    using the given lon, lat, N, path_file_axisem, distance_s, and optional conjugate flag.</span>
<span class="sd">    Returns the synthetic seismogram matrix.</span>

<span class="sd">    Args:</span>
<span class="sd">        spectrum_axi (numpy.ndarray): synthetic seismogram in frequency domain</span>
<span class="sd">        lon (numpy.ndarray): longitude of the grid</span>
<span class="sd">        lat (numpy.ndarray): latitude of the grid</span>
<span class="sd">        N (int): number of samples</span>
<span class="sd">        distance_s (numpy.ndarray): distance matrix</span>
<span class="sd">        comp (str, optional): component</span>
<span class="sd">        conjugate (bool, optional): conjugate flag</span>

<span class="sd">    Returns:</span>
<span class="sd">        synth (numpy.ndarray): synthetic seismogram</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">S_synth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">lon</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">lat</span><span class="p">),</span> <span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">complex</span><span class="p">)</span>
    <span class="n">distance_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">distance_s</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">min_dist</span><span class="p">,</span> <span class="n">max_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">distance_s</span><span class="o">.</span><span class="n">data</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">distance_s</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">min_dist</span><span class="p">,</span> <span class="n">max_dist</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">distance_synth</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_axi</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">dist</span> <span class="ow">in</span> <span class="n">distance</span><span class="p">:</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">distance_s</span><span class="o">.</span><span class="n">data</span> <span class="o">-</span> <span class="n">dist</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.09</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">trace</span> <span class="o">=</span> <span class="n">spectrum_axi</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">distance_synth</span> <span class="o">-</span> <span class="n">dist</span><span class="p">))),</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">complex</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span>
        <span class="k">if</span> <span class="n">conjugate</span><span class="p">:</span>
            <span class="n">S_synth</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">trace</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">S_synth</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">((</span><span class="n">trace</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">S_synth</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="wmsan.synthetics.open_archive" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">open_archive</span><span class="p">(</span><span class="n">h5_name</span><span class="o">=</span><span class="s1">&#39;spectrum_archive_tapered.h5&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Open an AxiSEM .h5 archive in a 1D model given its path,
and returns sampling frequency, time vector and trace.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>h5_name</code></b>
                  (<code>str</code>, default:
                      <code>&#39;spectrum_archive_tapered.h5&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>path of axisem .h5 archive</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>fe</code></b>(                  <code>float</code>
)              –
              <div class="doc-md-description">
                <p>sampling frequency</p>
              </div>
            </li>
            <li>
<b><code>freq</code></b>(                  <code><span title="numpy.ndarray">ndarray</span></code>
)              –
              <div class="doc-md-description">
                <p>frequency vector of the archive</p>
              </div>
            </li>
            <li>
<b><code>distance</code></b>(                  <code><span title="numpy.ndarray">ndarray</span></code>
)              –
              <div class="doc-md-description">
                <p>distance vector of the archive</p>
              </div>
            </li>
            <li>
<b><code>S</code></b>(                  <code><span title="numpy.ndarray">ndarray</span></code>
)              –
              <div class="doc-md-description">
                <p>synthetic spectra</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wmsan/synthetics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">open_archive</span><span class="p">(</span><span class="n">h5_name</span> <span class="o">=</span> <span class="s1">&#39;spectrum_archive_tapered.h5&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Open an AxiSEM .h5 archive in a 1D model given its path,</span>
<span class="sd">    and returns sampling frequency, time vector and trace.</span>

<span class="sd">    Args:</span>
<span class="sd">        h5_name (str, optional): path of axisem .h5 archive</span>

<span class="sd">    Returns:</span>
<span class="sd">        fe (float): sampling frequency</span>
<span class="sd">        freq (numpy.ndarray): frequency vector of the archive</span>
<span class="sd">        distance (numpy.ndarray): distance vector of the archive</span>
<span class="sd">        S (numpy.ndarray): synthetic spectra   </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">h5_file</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5_name</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">h5_file</span><span class="p">[</span><span class="s1">&#39;SPECTRUM&#39;</span><span class="p">][:]</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="n">h5_file</span><span class="p">[</span><span class="s1">&#39;distance&#39;</span><span class="p">][:]</span>
    <span class="n">freq</span> <span class="o">=</span> <span class="n">h5_file</span><span class="p">[</span><span class="s1">&#39;frequency&#39;</span><span class="p">][:]</span>
    <span class="n">h5_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">fe</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fe</span><span class="p">,</span> <span class="n">freq</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">S</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="wmsan.synthetics.open_axisem" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">open_axisem</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">path_file_axisem</span><span class="o">=</span><span class="s1">&#39;../../data/NOISE_vertforce_dirac_0-ak135f_1.s_3600s.h5&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Reads an AxiSEM .h5 archive in a 1D model given its path and a distance,
and returns sampling frequency, time vector and trace at the given distance.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>path_file_axisem</code></b>
                  (<code>str</code>, default:
                      <code>&#39;../../data/NOISE_vertforce_dirac_0-ak135f_1.s_3600s.h5&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>path of axisem .h5 archive</p>
              </div>
            </li>
            <li>
              <b><code>dist</code></b>
                  (<code>float</code>)
              –
              <div class="doc-md-description">
                <p>distance of interest</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>fe_iasp</code></b>(                  <code>float</code>
)              –
              <div class="doc-md-description">
                <p>sampling frequency </p>
              </div>
            </li>
            <li>
<b><code>time_iasp</code></b>(                  <code><span title="numpy.ndarray">ndarray</span></code>
)              –
              <div class="doc-md-description">
                <p>time vector of the archive</p>
              </div>
            </li>
            <li>
<b><code>trace_synth</code></b>(                  <code><span title="numpy.ndarray">ndarray</span></code>
)              –
              <div class="doc-md-description">
                <p>synthetic trace at the given distance.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wmsan/synthetics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">open_axisem</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">path_file_axisem</span><span class="o">=</span><span class="s1">&#39;../../data/NOISE_vertforce_dirac_0-ak135f_1.s_3600s.h5&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reads an AxiSEM .h5 archive in a 1D model given its path and a distance,</span>
<span class="sd">    and returns sampling frequency, time vector and trace at the given distance.</span>

<span class="sd">    Args:</span>
<span class="sd">        path_file_axisem (str, optional): path of axisem .h5 archive</span>
<span class="sd">        dist (float): distance of interest</span>

<span class="sd">    Returns:</span>
<span class="sd">        fe_iasp (float): sampling frequency </span>
<span class="sd">        time_iasp (numpy.ndarray): time vector of the archive</span>
<span class="sd">        trace_synth (numpy.ndarray): synthetic trace at the given distance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">h5_file</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">path_file_axisem</span><span class="p">)</span>
        <span class="n">trace_synth</span> <span class="o">=</span> <span class="n">h5_file</span><span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">][</span><span class="s1">&#39;SYNTH</span><span class="si">%03d</span><span class="s1">.00&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">dist</span><span class="o">*</span><span class="mi">10</span><span class="p">)][</span><span class="n">comp</span><span class="p">][:]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">single</span><span class="p">)</span>
        <span class="n">h5_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">raise</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;File not found&#39;</span><span class="p">,</span> <span class="n">path_file_axisem</span><span class="p">,</span> <span class="s2">&quot;Download the file from: https://zenodo.org/records/11126562 </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;Save in ../data/&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">trace_synth</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="wmsan.synthetics.open_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">open_model</span><span class="p">(</span><span class="n">path_file_WW3</span><span class="p">,</span> <span class="n">date_vect</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">fe</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">),</span> <span class="n">lat_slice</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">78</span><span class="p">,</span> <span class="mi">80</span><span class="p">))</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Open WW3 model for ambient noise sources at a specific time and date. 
Returns the PSD of the given model in N^2.s with dimensions (dim_lon, dim_lat, 2*dim_freq+1).</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>path_file_WW3</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Path of WW3 model archive in N.s^{1/2}.</p>
              </div>
            </li>
            <li>
              <b><code>date_vect</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              –
              <div class="doc-md-description">
                <p>Date and time vector [YEAR, MONTH, DAY, HOUR].</p>
              </div>
            </li>
            <li>
              <b><code>N</code></b>
                  (<code>int</code>)
              –
              <div class="doc-md-description">
                <p>Length of the spectrum.</p>
              </div>
            </li>
            <li>
              <b><code>fe</code></b>
                  (<code>float</code>)
              –
              <div class="doc-md-description">
                <p>Sampling frequency.</p>
              </div>
            </li>
            <li>
              <b><code>lon_slice</code></b>
                  (<code>slice</code>, default:
                      <code>slice(-180, 180)</code>
)
              –
              <div class="doc-md-description">
                <p>Slice of longitude to select.</p>
              </div>
            </li>
            <li>
              <b><code>lat_slice</code></b>
                  (<code>slice</code>, default:
                      <code>slice(-78, 80)</code>
)
              –
              <div class="doc-md-description">
                <p>Slice of latitude to select.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>force_spectrum</code></b>(                  <code><span title="xarray.DataArray">DataArray</span></code>
)              –
              <div class="doc-md-description">
                <p>Hermitian PSD of the given model in N^2.s with dimensions (dim_lon, dim_lat, 2*dim_freq+1).</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wmsan/synthetics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">open_model</span><span class="p">(</span><span class="n">path_file_WW3</span><span class="p">,</span> <span class="n">date_vect</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">fe</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">),</span> <span class="n">lat_slice</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">78</span><span class="p">,</span> <span class="mi">80</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Open WW3 model for ambient noise sources at a specific time and date. </span>
<span class="sd">    Returns the PSD of the given model in N^2.s with dimensions (dim_lon, dim_lat, 2*dim_freq+1).</span>

<span class="sd">    Args:</span>
<span class="sd">        path_file_WW3 (str): Path of WW3 model archive in N.s^{1/2}.</span>
<span class="sd">        date_vect (numpy.ndarray): Date and time vector [YEAR, MONTH, DAY, HOUR].</span>
<span class="sd">        N (int): Length of the spectrum.</span>
<span class="sd">        fe (float): Sampling frequency.</span>
<span class="sd">        lon_slice (slice, optional): Slice of longitude to select.</span>
<span class="sd">        lat_slice (slice, optional): Slice of latitude to select.</span>

<span class="sd">    Returns:</span>
<span class="sd">        force_spectrum (xarray.DataArray): Hermitian PSD of the given model in N^2.s with dimensions (dim_lon, dim_lat, 2*dim_freq+1).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">year</span> <span class="o">=</span> <span class="n">date_vect</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">month</span> <span class="o">=</span> <span class="n">date_vect</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">day</span> <span class="o">=</span> <span class="n">date_vect</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">hour</span> <span class="o">=</span> <span class="n">date_vect</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

    <span class="c1">## Open WW3 model </span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">path_file_WW3</span><span class="p">)</span>
    <span class="n">ww3_data</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">F_f</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">longitude</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">)</span>

    <span class="n">ww3_data</span> <span class="o">=</span> <span class="n">ww3_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">ds</span>
    <span class="n">ww3_data</span> <span class="o">=</span> <span class="n">ww3_data</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">ww3_data</span><span class="p">))</span>

    <span class="c1">## Spectrum Output</span>
    <span class="k">if</span> <span class="n">N</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">lenght_spectrum</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>  <span class="c1"># must be Hermitian</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lenght_spectrum</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># must be Hermitian</span>
    <span class="n">frequency</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">lenght_spectrum</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fe</span><span class="p">))</span>

    <span class="c1">## Interpolate over frequency range</span>
    <span class="n">force_0</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">ww3_data</span><span class="o">.</span><span class="n">longitude</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">ww3_data</span><span class="o">.</span><span class="n">latitude</span><span class="p">),</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;longitude&#39;</span><span class="p">:</span><span class="n">ww3_data</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="n">ww3_data</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="s1">&#39;frequency&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]})</span>
    <span class="n">force_2</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">ww3_data</span><span class="o">.</span><span class="n">longitude</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">ww3_data</span><span class="o">.</span><span class="n">latitude</span><span class="p">),</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;longitude&#39;</span><span class="p">:</span><span class="n">ww3_data</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="n">ww3_data</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="s1">&#39;frequency&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.</span><span class="p">]})</span>
    <span class="n">ww3_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">force_0</span><span class="p">,</span> <span class="n">ww3_data</span><span class="p">,</span> <span class="n">force_2</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;frequency&#39;</span><span class="p">)</span>
    <span class="n">force_spectrum</span> <span class="o">=</span> <span class="n">ww3_data</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">frequency</span><span class="o">=</span><span class="n">frequency</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">frequency</span><span class="o">&gt;=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">frequency</span> <span class="o">&lt;=</span> <span class="mf">2.</span><span class="p">)],</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fill_value&quot;</span><span class="p">:</span> <span class="mf">0.</span><span class="p">})</span>
    <span class="k">del</span> <span class="n">ww3_data</span>
    <span class="k">return</span> <span class="n">force_spectrum</span><span class="o">**</span><span class="mi">2</span>  <span class="c1"># in N^2.s</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="wmsan.synthetics.open_spectrum_axisem" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">open_spectrum_axisem</span><span class="p">(</span><span class="n">path_file_axisem</span><span class="o">=</span><span class="s1">&#39;./spectrum_vertforce_iasp91_1.s_256c_3600.s.h5&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Reads an AxiSEM .h5 archive in a 1D model given its path and component,
and returns sampling frequency, time vector and trace.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>path_file_axisem</code></b>
                  (<code>str</code>, default:
                      <code>&#39;./spectrum_vertforce_iasp91_1.s_256c_3600.s.h5&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>path of axisem .h5 archive</p>
              </div>
            </li>
            <li>
              <b><code>comp</code></b>
                  (<code>float</code>, default:
                      <code>&#39;Z&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>component</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>fe_iasp</code></b>(                  <code>float</code>
)              –
              <div class="doc-md-description">
                <p>sampling frequency </p>
              </div>
            </li>
            <li>
<b><code>time_iasp</code></b>(                  <code><span title="numpy.ndarray">ndarray</span></code>
)              –
              <div class="doc-md-description">
                <p>time vector of the archive</p>
              </div>
            </li>
            <li>
<b><code>dist_iasp</code></b>(                  <code><span title="numpy.ndarray">ndarray</span></code>
)              –
              <div class="doc-md-description">
                <p>distance vector of the archive</p>
              </div>
            </li>
            <li>
<b><code>spectrum_synth</code></b>(                  <code><span title="numpy.ndarray">ndarray</span></code>
)              –
              <div class="doc-md-description">
                <p>synthetic spectra</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wmsan/synthetics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">open_spectrum_axisem</span><span class="p">(</span><span class="n">path_file_axisem</span><span class="o">=</span><span class="s1">&#39;./spectrum_vertforce_iasp91_1.s_256c_3600.s.h5&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reads an AxiSEM .h5 archive in a 1D model given its path and component,</span>
<span class="sd">    and returns sampling frequency, time vector and trace.</span>

<span class="sd">    Args:</span>
<span class="sd">        path_file_axisem (str, optional): path of axisem .h5 archive</span>
<span class="sd">        comp (float): component</span>

<span class="sd">    Returns:</span>
<span class="sd">        fe_iasp (float): sampling frequency </span>
<span class="sd">        time_iasp (numpy.ndarray): time vector of the archive</span>
<span class="sd">        dist_iasp (numpy.ndarray): distance vector of the archive</span>
<span class="sd">        spectrum_synth (numpy.ndarray): synthetic spectra</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">h5_file</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">path_file_axisem</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">fe_iasp</span> <span class="o">=</span> <span class="n">h5_file</span><span class="p">[</span><span class="s1">&#39;_metadata&#39;</span><span class="p">][</span><span class="s1">&#39;fe&#39;</span><span class="p">][()]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">single</span><span class="p">)</span>
    <span class="n">time_iasp</span> <span class="o">=</span> <span class="n">h5_file</span><span class="p">[</span><span class="s1">&#39;_metadata&#39;</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">][:]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">single</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">time_iasp</span><span class="p">)</span>
    <span class="n">freq_iasp</span> <span class="o">=</span> <span class="n">h5_file</span><span class="p">[</span><span class="s1">&#39;_metadata&#39;</span><span class="p">][</span><span class="s1">&#39;freq&#39;</span><span class="p">][:]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">single</span><span class="p">)</span>
    <span class="n">index_freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">freq_iasp</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">,</span> <span class="n">freq_iasp</span><span class="o">&lt;=</span><span class="mf">2.</span><span class="p">)))</span>
    <span class="n">freq_iasp</span> <span class="o">=</span> <span class="n">freq_iasp</span><span class="p">[</span><span class="n">index_freq</span><span class="p">]</span>
    <span class="n">dist_iasp</span> <span class="o">=</span> <span class="n">h5_file</span><span class="p">[</span><span class="s1">&#39;_metadata&#39;</span><span class="p">][</span><span class="s1">&#39;dist&#39;</span><span class="p">][()]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">single</span><span class="p">)</span>
    <span class="n">spectrum_synth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">dist_iasp</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">freq_iasp</span><span class="p">)))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">csingle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">distance</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dist_iasp</span><span class="p">):</span>
        <span class="n">spectrum_synth</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">h5_file</span><span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">][</span><span class="s1">&#39;SYNTH</span><span class="si">%03d</span><span class="s1">.00&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">distance</span><span class="o">*</span><span class="mi">10</span><span class="p">)][</span><span class="n">comp</span><span class="p">][</span><span class="n">index_freq</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">csingle</span><span class="p">)</span>
    <span class="n">h5_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> 
    <span class="n">spectrum_synth</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">spectrum_synth</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;distance&#39;</span><span class="p">:</span><span class="n">dist_iasp</span><span class="p">,</span> <span class="s1">&#39;frequency&#39;</span><span class="p">:</span><span class="n">freq_iasp</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">fe_iasp</span><span class="p">,</span> <span class="n">freq_iasp</span><span class="p">,</span> <span class="n">time_iasp</span><span class="p">,</span> <span class="n">dist_iasp</span><span class="p">,</span> <span class="n">spectrum_synth</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="wmsan.synthetics.taper_axisem_archive" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">taper_axisem_archive</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">archive_name</span><span class="o">=</span><span class="s1">&#39;../../data/NOISE_vertforce_dirac_0-ak135f_1.s_3600s.h5&#39;</span><span class="p">,</span> <span class="n">umin</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">umax</span><span class="o">=</span><span class="mf">3.5</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Taper an AxiSEM .h5 archive in a 1D model given its path and distances as well as minimum and maximum Rayleigh wave velocity,and saves and returns the tapered archive.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>time</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              –
              <div class="doc-md-description">
                <p>time vector</p>
              </div>
            </li>
            <li>
              <b><code>distance</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              –
              <div class="doc-md-description">
                <p>distance vector</p>
              </div>
            </li>
            <li>
              <b><code>archive_name</code></b>
                  (<code>str</code>, default:
                      <code>&#39;../../data/NOISE_vertforce_dirac_0-ak135f_1.s_3600s.h5&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>path of axisem .h5 archive, default='../../data/NOISE_vertforce_dirac_0-ak135f_1.s_3600s.h5'</p>
              </div>
            </li>
            <li>
              <b><code>umin</code></b>
                  (<code>float</code>, default:
                      <code>2.5</code>
)
              –
              <div class="doc-md-description">
                <p>minimum Rayleigh wave velocity</p>
              </div>
            </li>
            <li>
              <b><code>umax</code></b>
                  (<code>float</code>, default:
                      <code>3.5</code>
)
              –
              <div class="doc-md-description">
                <p>maximum Rayleigh wave velocity</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>tapered_archive</code></b>(                  <code><span title="numpy.ndarray">ndarray</span></code>
)              –
              <div class="doc-md-description">
                <p>tapered archive</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wmsan/synthetics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">taper_axisem_archive</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">archive_name</span><span class="o">=</span><span class="s1">&#39;../../data/NOISE_vertforce_dirac_0-ak135f_1.s_3600s.h5&#39;</span><span class="p">,</span> <span class="n">umin</span> <span class="o">=</span> <span class="mf">2.5</span><span class="p">,</span> <span class="n">umax</span> <span class="o">=</span> <span class="mf">3.5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Taper an AxiSEM .h5 archive in a 1D model given its path and distances as well as minimum and maximum Rayleigh wave velocity,and saves and returns the tapered archive.</span>

<span class="sd">    Args:</span>
<span class="sd">        time (numpy.ndarray): time vector</span>
<span class="sd">        distance (numpy.ndarray): distance vector</span>
<span class="sd">        archive_name (str, optional): path of axisem .h5 archive, default=&#39;../../data/NOISE_vertforce_dirac_0-ak135f_1.s_3600s.h5&#39;</span>
<span class="sd">        umin (float, optional): minimum Rayleigh wave velocity</span>
<span class="sd">        umax (float, optional): maximum Rayleigh wave velocity</span>

<span class="sd">    Returns:</span>
<span class="sd">        tapered_archive (numpy.ndarray): tapered archive</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">radius_earth</span><span class="o">*</span><span class="mf">1e-3</span>  <span class="c1"># Radius of the Earth in km</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">time</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">fe</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dt</span>
    <span class="n">tapered_archive</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">distance</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dist</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">distance</span><span class="p">):</span>
        <span class="n">dist_in_km</span> <span class="o">=</span> <span class="n">dist</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">R</span><span class="o">/</span><span class="mi">180</span>
        <span class="n">tmin</span> <span class="o">=</span> <span class="n">dist_in_km</span><span class="o">/</span><span class="n">umax</span>
        <span class="n">tmax</span> <span class="o">=</span> <span class="n">dist_in_km</span><span class="o">/</span><span class="n">umin</span>
        <span class="k">if</span> <span class="n">tmax</span> <span class="o">&gt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">time</span><span class="p">):</span>
            <span class="n">tmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tmin</span> <span class="o">&gt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">time</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">dt_width</span> <span class="o">=</span> <span class="n">tmax</span> <span class="o">-</span> <span class="n">tmin</span> <span class="o">+</span> <span class="mi">50</span>
        <span class="c1">## Taper</span>
        <span class="n">tukey</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">tukey</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">dt_width</span><span class="o">*</span><span class="n">fe</span><span class="p">)),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">dirac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">))</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">time</span> <span class="o">-</span> <span class="p">(</span><span class="n">tmax</span> <span class="o">+</span> <span class="n">tmin</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">dirac</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">taper</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">fftconvolve</span><span class="p">(</span><span class="n">dirac</span><span class="p">,</span> <span class="n">tukey</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
        <span class="n">W</span> <span class="o">=</span> <span class="n">open_axisem</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">archive_name</span><span class="p">)</span>
        <span class="n">tapered_archive</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">W</span><span class="o">*</span><span class="n">taper</span>
    <span class="c1">## Save tapered archive as h5 file</span>
    <span class="n">h5_name_tapered</span> <span class="o">=</span> <span class="n">archive_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;s.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;_tapered.s.h5&#39;</span><span class="p">)</span>
    <span class="n">h5_file</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5_name_tapered</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">h5_file</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;WAVEFORMS&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tapered_archive</span><span class="p">)</span>
    <span class="n">h5_file</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">time</span><span class="p">)</span>
    <span class="n">h5_file</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;distance&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">distance</span><span class="p">)</span>
    <span class="n">h5_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">tapered_archive</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="wmsan.synthetics.taper_axisem_archive_body_waves" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">taper_axisem_archive_body_waves</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">archive_name</span><span class="o">=</span><span class="s1">&#39;../../data/NOISE_vertforce_dirac_0-ak135f_1.s_3600s.h5&#39;</span><span class="p">,</span> <span class="n">phase1</span><span class="o">=</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="n">phase2</span><span class="o">=</span><span class="s1">&#39;PP&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;ak135&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Taper an AxiSEM .h5 archive around two body wave phases in a 1D model given its path and a distance,
and returns the tapered archive.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>time</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              –
              <div class="doc-md-description">
                <p>time vector.</p>
              </div>
            </li>
            <li>
              <b><code>distance</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              –
              <div class="doc-md-description">
                <p>distance vector.</p>
              </div>
            </li>
            <li>
              <b><code>archive_name</code></b>
                  (<code>str</code>, default:
                      <code>&#39;../../data/NOISE_vertforce_dirac_0-ak135f_1.s_3600s.h5&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>path of axisem .h5 archive</p>
              </div>
            </li>
            <li>
              <b><code>phase1</code></b>
                  (<code>str</code>, default:
                      <code>&#39;P&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>first body wave phase.</p>
              </div>
            </li>
            <li>
              <b><code>phase2</code></b>
                  (<code>str</code>, default:
                      <code>&#39;PP&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>second body wave phase.</p>
              </div>
            </li>
            <li>
              <b><code>model</code></b>
                  (<code>str</code>, default:
                      <code>&#39;ak135&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>model to compute arrival times with TauP.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>fe_iasp</code></b>(                  <code>float</code>
)              –
              <div class="doc-md-description">
                <p>sampling frequency.</p>
              </div>
            </li>
            <li>
<b><code>time_iasp</code></b>(                  <code><span title="numpy.ndarray">ndarray</span></code>
)              –
              <div class="doc-md-description">
                <p>time vector of the archive.</p>
              </div>
            </li>
            <li>
<b><code>trace_synth</code></b>(                  <code><span title="numpy.ndarray">ndarray</span></code>
)              –
              <div class="doc-md-description">
                <p>synthetic trace at the given distance.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wmsan/synthetics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">taper_axisem_archive_body_waves</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">archive_name</span><span class="o">=</span><span class="s1">&#39;../../data/NOISE_vertforce_dirac_0-ak135f_1.s_3600s.h5&#39;</span><span class="p">,</span> <span class="n">phase1</span> <span class="o">=</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="n">phase2</span> <span class="o">=</span> <span class="s1">&#39;PP&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;ak135&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Taper an AxiSEM .h5 archive around two body wave phases in a 1D model given its path and a distance,</span>
<span class="sd">    and returns the tapered archive.</span>

<span class="sd">    Args:</span>
<span class="sd">        time (numpy.ndarray): time vector.</span>
<span class="sd">        distance (numpy.ndarray): distance vector.</span>
<span class="sd">        archive_name (str, optional): path of axisem .h5 archive</span>
<span class="sd">        phase1 (str, optional): first body wave phase.</span>
<span class="sd">        phase2 (str, optional): second body wave phase.</span>
<span class="sd">        model (str, optional): model to compute arrival times with TauP.</span>

<span class="sd">    Returns:</span>
<span class="sd">        fe_iasp (float): sampling frequency.</span>
<span class="sd">        time_iasp (numpy.ndarray): time vector of the archive.</span>
<span class="sd">        trace_synth (numpy.ndarray): synthetic trace at the given distance.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">R</span> <span class="o">=</span> <span class="n">radius_earth</span><span class="o">*</span><span class="mf">1e-3</span>  <span class="c1"># Radius of the Earth in km</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">time</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">fe</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dt</span>
    <span class="n">tapered_archive</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">distance</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>

    <span class="c1">## IASP travel times TauP</span>
    <span class="n">model_1D</span> <span class="o">=</span> <span class="n">TauPyModel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">model</span><span class="p">)</span>
    <span class="n">tP_IASP</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tPP_IASP</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">180.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dist</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">arr_phase1</span> <span class="o">=</span> <span class="n">model_1D</span><span class="o">.</span><span class="n">get_travel_times</span><span class="p">(</span><span class="n">source_depth_in_km</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">distance_in_degree</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">phase_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">phase1</span><span class="p">])</span>
            <span class="n">t_phase1</span> <span class="o">=</span> <span class="n">arr_phase1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">t_phase1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="k">try</span><span class="p">:</span>    
            <span class="n">arr_phase2</span> <span class="o">=</span> <span class="n">model_1D</span><span class="o">.</span><span class="n">get_travel_times</span><span class="p">(</span><span class="n">source_depth_in_km</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">distance_in_degree</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">phase_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">phase2</span><span class="p">])</span>
            <span class="n">t_phase2</span> <span class="o">=</span> <span class="n">arr_phase2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">t_phase2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">dist_in_km</span> <span class="o">=</span> <span class="n">dist</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">R</span><span class="o">/</span><span class="mi">180</span>
        <span class="c1"># Window around TauP</span>
        <span class="n">tukey_window</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">tukey</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">50</span><span class="o">*</span><span class="n">fe</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">sym</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">dirac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">t_phase1</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">t_phase1</span><span class="o">*</span><span class="n">fe</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">t_phase2</span><span class="o">*</span><span class="n">fe</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t_phase2</span><span class="o">*</span><span class="n">fe</span><span class="p">)</span>
        <span class="n">dirac</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">window</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">fftconvolve</span><span class="p">(</span><span class="n">dirac</span><span class="p">,</span> <span class="n">tukey_window</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
        <span class="n">W</span> <span class="o">=</span> <span class="n">open_axisem</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">archive_name</span><span class="p">)</span>
        <span class="n">tapered_archive</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">W</span><span class="o">*</span><span class="n">window</span>

    <span class="c1">## Save tapered archive as h5 file</span>
    <span class="n">h5_name_tapered</span> <span class="o">=</span> <span class="n">archive_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;s.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;_tapered_</span><span class="si">%s</span><span class="s1">_</span><span class="si">%s</span><span class="s1">.h5&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">phase1</span><span class="p">,</span> <span class="n">phase2</span><span class="p">))</span>
    <span class="n">h5_file</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5_name_tapered</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">h5_file</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;WAVEFORMS&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tapered_archive</span><span class="p">)</span>
    <span class="n">h5_file</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">time</span><span class="p">)</span>
    <span class="n">h5_file</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;distance&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">distance</span><span class="p">)</span>
    <span class="n">h5_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">tapered_archive</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../temporal_variations/" class="btn btn-neutral float-left" title="Temporal Variations"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../wmsan_to_noisi/" class="btn btn-neutral float-right" title="To noisi">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://gricad-gitlab.univ-grenoble-alpes.fr/tomasetl/ww3-source-maps" class="icon icon-gitlab" style="color: #fcfcfc"> GitLab</a>
        </span>
    
    
      <span><a href="../temporal_variations/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../wmsan_to_noisi/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
